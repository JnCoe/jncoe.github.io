---
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
	const blogEntries = await getCollection('blog', ({ data }) => !data.draft);
	return blogEntries.map(entry => ({
		params: { slug: entry.id.replace(/\.md$/, '') },
		props: { entry },
	}));
}

interface Props {
	entry: any;
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const { title, description, pubDate, updatedDate, author, tags } = entry.data;
---

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>{title} | Jonas Coelho</title>
	<meta name="description" content={description} />
	
	<!-- Favicon -->
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üé≤</text></svg>">

	<!-- Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

	<!-- Site styles -->
	<link rel="stylesheet" href="/css/variables.css">
	<link rel="stylesheet" href="/css/base.css">
	<link rel="stylesheet" href="/css/components.css">
	<link rel="stylesheet" href="/css/layout.css">
</head>
<body>
	<!-- Sidebar Navigation -->
	<aside class="sidebar" id="sidebar">
		<div class="sidebar-content">
			<div class="sidebar-header">
				<h1 class="sidebar-logo">Menu</h1>
				<button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
					<i class="fas fa-moon"></i>
				</button>
			</div>
			<nav class="sidebar-nav">
				<ul>
					<li><a href="/#about" class="nav-link">About Me</a></li>
					<li><a href="/#journey" class="nav-link">My Journey</a></li>
					<li><a href="/#projects" class="nav-link">Projects</a></li>
					<li><a href="/#contact" class="nav-link">Contact</a></li>
				</ul>
				<hr style="border: none; border-top: 1px solid rgba(255, 255, 255, 0.15); margin: var(--space-lg) 0;">
				<ul style="list-style: none; padding: 0; margin: 0;">
					<li><a href="/blog/" class="nav-link active" style="background: rgba(255, 255, 255, 0.15); border: 2px solid rgba(255, 255, 255, 0.3); border-radius: var(--radius-md);">üìù Blog</a></li>
				</ul>
			</nav>
			<div class="sidebar-footer">
				<div class="social-links">
					<a href="https://www.linkedin.com/in/jonasbarros/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
						<i class="fab fa-linkedin"></i>
					</a>
					<a href="https://github.com/JnCoe" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
						<i class="fab fa-github"></i>
					</a>
				</div>
			</div>
		</div>
	</aside>

	<!-- Mobile Header -->
	<header class="mobile-header" id="mobileHeader">
		<button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
			<span></span>
			<span></span>
			<span></span>
		</button>
		<span class="mobile-title">Jonas Coelho</span>
		<button class="theme-toggle-mobile" id="themeToggleMobile" aria-label="Toggle dark mode">
			<i class="fas fa-moon"></i>
		</button>
	</header>

	<main class="main-content">
		<section class="hero-section">
			<div class="hero-content">
				<h1 class="hero-title">Jonas Coelho</h1>
				<div class="hero-subtitle">
					<span class="typing-text">Blog</span>
				</div>
			</div>
		</section>

		<section class="section">
			<div class="container">
				<nav style="margin-bottom: var(--space-lg);">
					<a href="/blog/" style="display:inline-block; padding:0; color: var(--color-primary); text-decoration: none;">‚Üê Back to Blog</a>
				</nav>

				<article>
					<h1 style="font-family: var(--font-family-base); font-size: var(--font-size-4xl); font-weight: var(--font-weight-bold); line-height: var(--line-height-tight); color: var(--text-primary); margin-bottom: var(--space-lg);">{title}</h1>

					<div class="timeline-subtitle" style="margin-bottom: var(--space-xl); color: var(--text-secondary);">
						<span>By {author}</span>
						<span style="margin-left: var(--space-md);">Published: {pubDate.toLocaleDateString()}</span>
						{updatedDate && <span style="margin-left: var(--space-md);">Updated: {updatedDate.toLocaleDateString()}</span>}
					</div>

					<div>
						<Content />
					</div>

					{tags.length > 0 && (
						<div class="project-tags" style="margin-top: var(--space-xl);">
							{tags.map(tag => (
								<span class="project-tag">#{tag}</span>
							))}
						</div>
					)}
				</article>

				<div style="margin-top: var(--space-xl);">
					<a href="/blog/" class="btn btn-secondary">‚Üê All Posts</a>
				</div>
			</div>
		</section>

		<footer class="footer">
			<div class="container" style="background: transparent;">
				<p>&copy; Jonas Coelho. Some rights may be reserved.</p>
			</div>
		</footer>
	</main>

	<!-- Scripts (optional) -->
	<script type="module" src="/js/main.js"></script>
</body>
</html>
